(this["webpackJsonpgamehub-frontend"]=this["webpackJsonpgamehub-frontend"]||[]).push([[0],{67:function(e,t,n){},68:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n.n(r),a=n(25),c=n.n(a),i=(n(67),n(68),n(59)),o=n(104),u=n(5),l=n.n(u),d=n(11),b=n(13),m=n(81),j=(n(70),n(43)),p=n(9),f=n(102),h=n(103),g=n(83),v=n(105),x=n(22),O=n(23),y="https://gamehub-service.herokuapp.com",k=function(){function e(){Object(x.a)(this,e)}return Object(O.a)(e,null,[{key:"GET",value:function(){var t=Object(d.a)(l.a.mark((function t(n,r){var s,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=void 0,a={method:"GET",referrerPolicy:"no-referrer",mode:"cors",headers:{}},t.prev=2,t.next=5,fetch(r?"".concat(n,"?").concat(e.createQuery(r)):n,a);case 5:s=t.sent,t.next=11;break;case 8:return t.prev=8,t.t0=t.catch(2),t.abrupt("return",t.t0);case 11:return t.abrupt("return",s);case 12:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e,n){return t.apply(this,arguments)}}()},{key:"POST",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},s=void 0,e.prev=2,e.next=5,fetch(t,r);case 5:s=e.sent,e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",e.t0);case 11:return e.abrupt("return",s);case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"PATCH",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},s=void 0,e.prev=2,e.next=5,fetch(t,r);case 5:s=e.sent,e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",e.t0);case 11:return e.abrupt("return",s);case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"DELETE",value:function(){var t=Object(d.a)(l.a.mark((function t(n,r){var s,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=void 0,a={method:"DELETE",referrerPolicy:"no-referrer",mode:"cors",headers:{}},t.prev=2,t.next=5,fetch(r?"".concat(n,"?").concat(e.createQuery(r)):n,a);case 5:s=t.sent,t.next=11;break;case 8:return t.prev=8,t.t0=t.catch(2),t.abrupt("return",t.t0);case 11:return t.abrupt("return",s);case 12:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e,n){return t.apply(this,arguments)}}()},{key:"createQuery",value:function(e){return Object.entries(e).filter((function(e){return void 0!==e[1]&&""!==e[1]&&null!==e[1]})).map((function(e){return e.join("=")})).join("&")}}]),e}(),N=function(){function e(){Object(x.a)(this,e)}return Object(O.a)(e,null,[{key:"sendSubscription",value:function(e){console.log(e),k.POST("".concat(y,"/subscription/"),e)}},{key:"deleteSubscription",value:function(e){console.log(e)}}]),e}();N.module="notifications";var w=N;navigator.serviceWorker.register("./service-worker.js");var S=function(){function e(){Object(x.a)(this,e)}return Object(O.a)(e,null,[{key:"subscribed",get:function(){return new Promise((function(e){navigator.serviceWorker&&navigator.serviceWorker.ready?navigator.serviceWorker.ready.then((function(t){t.pushManager.getSubscription().then((function(t){e(!!t)})).catch((function(t){return e(!1)}))})).catch((function(t){return e(!1)})):(console.log("a.no"),e(!1))}))}},{key:"checkBrowserSupport",value:function(){return"Notification"in window?"serviceWorker"in navigator?"showNotification"in ServiceWorkerRegistration.prototype?"PushManager"in window?{message:"El navegador soporta las notificaciones",status:1}:(console.warn("Push messaging isn't supported."),{message:"El navegador no soporta notificaciones (WebPushNotifications)",status:0}):(console.warn("Notifications aren't supported. on serviceWorkers"),{message:"El navegador no soporta serviceWorkers para las notificaciones",status:0}):(console.log("This browser does not support serviceWorkers."),{message:"El navegador no soporta serviceWorkers para las notificaciones",status:0}):(console.log("This browser does not support notifications."),{message:"El navegador no soporta notificaciones",status:0})}},{key:"askNotificationPermission",value:function(){var t=Object(d.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==(n=e.checkBrowserSupport()).status){t.next=3;break}return t.abrupt("return",n);case 3:return t.next=5,Notification.requestPermission();case 5:if("denied"!==Notification.permission&&"default"!==Notification.permission){t.next=7;break}return t.abrupt("return",{message:"No se ha brindado el permiso para enviar notificaciones",status:0});case 7:return t.abrupt("return",{message:"Permiso para las notificaciones concedido",status:1});case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"subscribe",value:function(){var t=Object(d.a)(l.a.mark((function t(){var n,r,s,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),r=new Uint8Array(n.length),s=0;s<n.length;++s)r[s]=n.charCodeAt(s);return r},t.next=3,e.subscribed;case 3:if(t.t0=t.sent,!0!==t.t0){t.next=6;break}return t.abrupt("return",{message:"Ya se encuentra suscrito",status:0});case 6:return t.next=8,e.askNotificationPermission();case 8:if(0!==(n=t.sent).status){t.next=11;break}return t.abrupt("return",n);case 11:return t.next=13,navigator.serviceWorker.ready;case 13:return r=t.sent,t.next=16,r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:s("BFp4VA9Bq1QWQpFVYL8mfQYgEq4BJXIYP3j7mjmMymlc8euQDJJBYTVGO3NEyjSc0TIsoIfbBXaya63duK8KoGY")});case 16:return t.next=18,r.pushManager.getSubscription();case 18:return a=t.sent,w.sendSubscription(a.toJSON()),t.abrupt("return",{message:"Suscrito a notificaciones",status:1});case 21:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"unsubscribe",value:function(){var t=Object(d.a)(l.a.mark((function t(){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.subscribed;case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,navigator.serviceWorker.ready;case 7:return n=t.sent,t.next=10,n.pushManager.getSubscription();case 10:r=t.sent,w.deleteSubscription(r.toJSON()),r.unsubscribe();case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),e}(),E=n(32),P=function(){function e(){Object(x.a)(this,e)}return Object(O.a)(e,null,[{key:"get",value:function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k.GET("".concat(y,"/").concat(e.module,"/").concat(n));case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},{key:"getGames",value:function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k.GET("".concat(y,"/").concat(e.module,"/"));case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}}()},{key:"getGamesWithDiscount",value:function(){var t=Object(d.a)(l.a.mark((function t(){var n,r,s,a=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.length>0&&void 0!==a[0]?a[0]:6,r=a.length>1&&void 0!==a[1]?a[1]:void 0){t.next=10;break}return t.next=5,e.getGames();case 5:if(!(s=t.sent).ok){t.next=10;break}return t.next=9,s.json();case 9:r=t.sent.data;case 10:if(!r){t.next=12;break}return t.abrupt("return",Object(E.a)(r).sort((function(e,t){return void 0===e.discounts&&(e.discounts=Object.values(e.stores).map((function(t,n){return 1===t.status&&"0%"!==t.discount?{store:Object.keys(e.stores)[n],discount:Number(t.discount.replace("%",""))}:null})).filter((function(e){return null!=e})).sort((function(e,t){return t.discount-e.discount}))),void 0===t.discounts&&(t.discounts=Object.values(t.stores).map((function(e,n){return 1===e.status&&"0%"!==e.discount?{store:Object.keys(t.stores)[n],discount:Number(e.discount.replace("%",""))}:null})).filter((function(e){return null!=e})).sort((function(e,t){return t.discount-e.discount}))),e.discounts.length>0&&t.discounts.length>0?t.discounts[0].discount>e.discounts[0].discount?1:-1:e.discounts.length>0?-1:t.discounts.length>0?1:0})).slice(0,n-1));case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"orderGamesStoresByPrice",value:function(e){e.forEach((function(e){e.stores=Object.fromEntries(Object.entries(e.stores).filter((function(e){return 1===Object(b.a)(e,2)[1].status})).sort((function(e,t){var n=Object(b.a)(e,2)[1],r=Object(b.a)(t,2)[1];return n.price-r.price})))}))}}]),e}();P.module="games";n(71);var T=n(2),W=function(e){return Object(T.jsxs)(m.a,{className:"game-item-container",elevation:3,children:[Object(T.jsx)("img",{src:e.game.image_url,alt:"Imagen de "+e.game.name,className:"game-item-img"}),Object(T.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"200px",height:"100%"},children:[Object(T.jsx)(j.b,{className:"game-item-title",to:"/games/"+e.game.id,children:e.game.name}),Object(T.jsx)("div",{className:"game-item-details",children:e.game.discounts.length>0?Object(T.jsxs)("a",{href:e.game.stores_urls[e.game.discounts[0].store],target:"_blank",rel:"noreferrer",className:"game-item-discount-container",children:[Object(T.jsxs)("div",{className:"game-item-discount-price",children:[Object(T.jsx)("div",{children:Object(T.jsxs)("span",{children:["$",e.game.stores[e.game.discounts[0].store].price]})}),Object(T.jsxs)("div",{children:[Object(T.jsx)("span",{children:"-"}),e.game.discounts[0].discount,Object(T.jsx)("span",{children:"%"})]})]}),Object(T.jsxs)("div",{className:"game-item-discount-store",children:["En ",e.game.discounts[0].store.replace("_"," ").toUpperCase()]})]}):Object(T.jsxs)("a",{href:Object.values(e.game.stores_urls)[0],target:"_blank",rel:"noreferrer",className:"game-item-discount-container",children:[Object(T.jsx)("div",{className:"game-item-discount-price",children:Object(T.jsxs)("div",{children:["$",Object.values(e.game.stores)[0].price]})}),Object(T.jsxs)("div",{className:"game-item-discount-store",children:["En ",Object.keys(e.game.stores)[0].replace("_"," ").toUpperCase()]})]})})]})]})},C=n(106),_=n(101),B=n(57),G=n.n(B),F=[],A=function(e){var t=Object(r.useState)(""),n=Object(b.a)(t,2),s=n[0],a=n[1],c=Object(r.useState)([]),i=Object(b.a)(c,2),o=i[0],u=i[1],j=Object(r.useState)([]),p=Object(b.a)(j,2),f=p[0],h=p[1],g=Object(r.useState)(!1),v=Object(b.a)(g,2),x=v[0],O=v[1];Object(r.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,P.getGames();case 3:if(!(t=e.sent).ok){e.next=16;break}return e.next=7,t.json();case 7:return n=e.sent.data,e.next=10,P.getGamesWithDiscount(5,n);case 10:r=e.sent,P.orderGamesStoresByPrice(n),console.log(n),u(n),F=n,h(r);case 16:O(!1);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[e]),Object(r.useEffect)((function(){u(F.filter((function(e){return e.name.toLowerCase().includes(s.toLowerCase())})))}),[s]);return Object(T.jsxs)("div",{className:"games-container",children:[Object(T.jsx)("h1",{className:"games-container-title",children:"Mayores descuentos"}),Object(T.jsxs)("div",{className:"games-items-container",children:[f.map((function(e){return Object(T.jsx)(W,{game:e},e.id)})),!0===x?Object(E.a)(Array(6).keys()).map((function(e){return Object(T.jsx)(m.a,{className:"game-item-container",elevation:3,children:Object(T.jsx)("div",{className:"game-item-img loading"})},e)})):null]}),Object(T.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},children:[Object(T.jsx)("h1",{className:"games-container-title",children:"Todos los juegos"}),Object(T.jsx)(C.a,{placeholder:"Buscar juego...",className:"games-search",onChange:function(e){a(e.target.value)},variant:"outlined",endAdornment:Object(T.jsx)(_.a,{position:"end",children:Object(T.jsx)(G.a,{})}),style:{margin:"auto 0",width:"50%",minWidth:"200px"}})]}),Object(T.jsxs)("div",{className:"games-items-container",children:[o.map((function(e){return Object(T.jsx)(W,{game:e},e.id)})),!0===x?Object(E.a)(Array(6).keys()).map((function(e){return Object(T.jsx)(m.a,{className:"game-item-container",elevation:3,children:Object(T.jsx)("div",{className:"game-item-img loading"})},e)})):null]})]})},J=n(58),M=n.n(J),D=function(e){var t=Object(r.useState)({stores:{}}),n=Object(b.a)(t,2),s=n[0],a=n[1],c=Object(r.useState)(!1),i=Object(b.a)(c,2),o=i[0],u=i[1],j=e.match.params.id;return Object(r.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,P.get(j);case 3:if(!(t=e.sent).ok){e.next=10;break}return e.next=7,t.json();case 7:n=e.sent,P.orderGamesStoresByPrice([n]),a(n);case 10:u(!1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[j]),console.log(s),o?Object(T.jsxs)("div",{className:"game-container",children:[Object(T.jsx)("div",{children:Object(T.jsx)("div",{className:"game-img loading"})}),Object(T.jsx)("div",{children:Object(T.jsx)("div",{className:"game-container-title loading",style:{width:"80%",height:"64px"}})})]}):Object(T.jsxs)("div",{className:"game-container",children:[Object(T.jsx)("div",{children:Object(T.jsx)("img",{src:s.image_url,alt:"Imagen de "+s.name,className:"game-img"})}),Object(T.jsxs)("div",{children:[Object(T.jsx)("h1",{className:"game-container-title",children:s.name}),Object(T.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",width:"100%"},children:[void 0!==s.hltb?Object(T.jsxs)("a",{className:"game-hltb-container",href:"https://howlongtobeat.com/game?id=".concat(s.hltb_game_id),target:"_blank",rel:"noreferrer",children:[Object(T.jsx)("img",{src:"assets/images/hltb.png",alt:""}),Object(T.jsx)("h3",{children:Object.keys(s.hltb[0])[1].replace("-"," ")}),s.hltb.map((function(e){return Object(T.jsxs)("div",{className:"game-hltb-item",children:[Object(T.jsx)("div",{children:Object.values(e)[1]}),Object(T.jsx)("div",{children:e.Average})]},Object.values(e)[1])}))]}):"",void 0!==s.metacritic?Object(T.jsxs)("a",{className:"game-metacritic-container",href:s.metacritic_url,target:"_blank",rel:"noreferrer",children:[Object(T.jsx)("img",{src:"assets/images/metacritic.png",alt:""}),Object(T.jsxs)("div",{children:[Object(T.jsx)("h4",{children:"Metascore"}),Object(T.jsx)("div",{className:"game-metascore-container",score:Number(s.metacritic.metascore)>=75?"nice":Number(s.metacritic.metascore)<50?"bad":"regular",children:s.metacritic.metascore})]}),Object(T.jsxs)("div",{children:[Object(T.jsx)("h4",{children:"Userscore"}),Object(T.jsx)("div",{className:"game-userscore-container",score:Number(s.metacritic.userscore)>=7.5?"nice":Number(s.metacritic.userscore)<5?"bad":"regular",children:s.metacritic.userscore})]})]}):"",Object(T.jsxs)("div",{className:"game-stores-container",children:[Object(T.jsx)("div",{className:"game-stores-icon",children:Object(T.jsx)(M.a,{})}),Object.entries(s.stores).map((function(e,t){var n=Object(b.a)(e,2),r=n[0],a=n[1];return Object(T.jsx)("a",{href:s.stores_urls[r],target:"_blank",rel:"noreferrer",style:{textDecoration:"none !important"},children:Object(T.jsxs)(m.a,{className:"game-store-item",children:[Object(T.jsx)("img",{src:"assets/images/".concat(r,".png"),alt:""}),Object(T.jsxs)("div",{className:"game-store-price-details",children:[Object(T.jsx)("span",{children:"0%"!==a.discount?"-"+a.discount:""}),Object(T.jsxs)("div",{children:["0%"!==a.discount?Object(T.jsxs)("div",{children:["$",(100*a.price/(100-Number(a.discount.replace("%","")))).toFixed(2)]}):"","$",a.price]})]})]})},r)}))]})]})]})]})},I=function(){var e=s.a.useState(!1),t=Object(b.a)(e,2),n=t[0],r=t[1];function a(){return(a=Object(d.a)(l.a.mark((function e(){var t,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=7;break}return e.next=3,S.subscribe();case 3:1===(t=e.sent).status?r((function(e){return!e})):console.log(t.message),e.next=12;break;case 7:return e.next=9,S.unsubscribe();case 9:s=e.sent,console.log(s),r((function(e){return!e}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return S.subscribed.then((function(e){return r(e)})),Object(T.jsxs)("div",{className:"main-container",children:[Object(T.jsx)(f.a,{position:"static",className:"appbar",children:Object(T.jsxs)(h.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(T.jsxs)("a",{href:"#/games",style:{display:"flex"},children:[Object(T.jsx)("img",{src:"assets/images/white-icon-512x512.png",alt:"",className:"toolbar-icon",srcSet:"assets/images/icon.svg"}),Object(T.jsx)(g.a,{variant:"h6",className:"main-title",children:"gamehub"})]}),Object(T.jsxs)("div",{style:{display:"flex"},children:[Object(T.jsx)("span",{style:{marginRight:"10px"},children:"Notificaciones"}),Object(T.jsx)(v.a,{size:"small",checked:n,onChange:function(){return a.apply(this,arguments)},color:"secondary"})]})]})}),Object(T.jsx)("div",{style:{display:"flex",height:"min-content",backgroundColor:"#f5f5f5",paddingBottom:"50px"},children:Object(T.jsx)(m.a,{style:{width:"95%",margin:"10px auto",height:"min-content"},elevation:3,children:Object(T.jsx)(j.a,{children:Object(T.jsxs)(p.d,{children:[Object(T.jsx)(p.b,{path:"/games",exact:!0,children:Object(T.jsx)(A,{})}),Object(T.jsx)(p.b,{path:"/games/:id",exact:!0,component:D}),Object(T.jsx)(p.a,{path:"",to:"/games"})]})})})})]})};var L=function(){var e=Object(i.a)({palette:{primary:{main:"#5A3E87"},secondary:{main:"#FFFFFF"}}});return Object(T.jsx)(o.a,{theme:e,children:Object(T.jsx)("div",{className:"App",children:Object(T.jsx)(I,{})})})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,107)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),s(e),a(e),c(e)}))};c.a.render(Object(T.jsx)(s.a.StrictMode,{children:Object(T.jsx)(L,{})}),document.getElementById("root")),Q()}},[[79,1,2]]]);
//# sourceMappingURL=main.e4c1b6f1.chunk.js.map